{
    "Entities": [
        {
            "EntityId": "entity_1",
            "EntityName": "Operation Triangulation",
            "EntityType": "event",
            "EntitySubType": "event",
            "Labels": [
                "TA0001",
                "TA0002",
                "TA0005",
                "TA0008"
            ],
            "Times": [
                "1"
            ],
            "Properties": {
                "date": "December 2023",
                "target": "iOS devices up to iOS 16.2",
                "observe_time": "2023",
                "report_name": "2023_Kaspersky_OperationTriangulation-TheLastMystery(12-27-2023)_0e4f0f8d"
            }
        },
        {
            "EntityId": "entity_2",
            "EntityName": "CVE-2023-41990",
            "EntityType": "vul",
            "EntitySubType": "cve",
            "Labels": [
                "TA0001"
            ],
            "Times": [
                "2"
            ],
            "Properties": {
                "description": "Remote code execution vulnerability in Apple's undocumented ADJUST TrueType font instruction"
            }
        },
        {
            "EntityId": "entity_3",
            "EntityName": "CVE-2023-32434",
            "EntityType": "vul",
            "EntitySubType": "cve",
            "Labels": [
                "TA0004"
            ],
            "Times": [
                "3"
            ],
            "Properties": {
                "description": "Integer overflow vulnerability in XNU's memory mapping syscalls (mach_make_memory_entry and vm_map)"
            }
        },
        {
            "EntityId": "entity_4",
            "EntityName": "CVE-2023-38606",
            "EntityType": "vul",
            "EntitySubType": "cve",
            "Labels": [
                "TA0005"
            ],
            "Times": [
                "4"
            ],
            "Properties": {
                "description": "Hardware-based security protection bypass using MMIO registers"
            }
        },
        {
            "EntityId": "entity_5",
            "EntityName": "CVE-2023-32435",
            "EntityType": "vul",
            "EntitySubType": "cve",
            "Labels": [
                "TA0002"
            ],
            "Times": [
                "5"
            ],
            "Properties": {
                "description": "Safari exploit vulnerability"
            }
        },
        {
            "EntityId": "entity_6",
            "EntityName": "JavaScriptCore",
            "EntityType": "env",
            "EntitySubType": "software",
            "Labels": [
                "TA0002"
            ],
            "Times": [
                "3"
            ]
        },
        {
            "EntityId": "entity_7",
            "EntityName": "DollarVM ($vm)",
            "EntityType": "tool",
            "EntitySubType": "tool",
            "Labels": [
                "TA0002"
            ],
            "Times": [
                "3"
            ],
            "Properties": {
                "description": "JavaScriptCore debugging feature"
            }
        },
        {
            "EntityId": "entity_8",
            "EntityName": "GPU coprocessor",
            "EntityType": "env",
            "EntitySubType": "hardware",
            "Labels": [
                "TA0005"
            ],
            "Times": [
                "4"
            ],
            "Properties": {
                "model": "Apple A12-A16 Bionic SoCs"
            }
        },
        {
            "EntityId": "entity_9",
            "EntityName": "0x206040000",
            "EntityType": "ioc",
            "EntitySubType": "payload",
            "Labels": [
                "TA0005"
            ],
            "Times": [
                "4"
            ],
            "Properties": {
                "type": "MMIO register",
                "purpose": "Controls CPU halting/unhalting"
            }
        },
        {
            "EntityId": "entity_10",
            "EntityName": "0x206140008",
            "EntityType": "ioc",
            "EntitySubType": "payload",
            "Labels": [
                "TA0005"
            ],
            "Times": [
                "4"
            ],
            "Properties": {
                "type": "MMIO register",
                "purpose": "Controls hardware feature enabling"
            }
        },
        {
            "EntityId": "entity_11",
            "EntityName": "0x206140108",
            "EntityType": "ioc",
            "EntitySubType": "payload",
            "Labels": [
                "TA0005"
            ],
            "Times": [
                "4"
            ],
            "Properties": {
                "type": "MMIO register",
                "purpose": "Controls hardware feature running"
            }
        },
        {
            "EntityId": "entity_12",
            "EntityName": "0x206150020",
            "EntityType": "ioc",
            "EntitySubType": "payload",
            "Labels": [
                "TA0005"
            ],
            "Times": [
                "4"
            ],
            "Properties": {
                "type": "MMIO register",
                "purpose": "Used for Apple A15/A16 Bionic SoCs"
            }
        },
        {
            "EntityId": "entity_13",
            "EntityName": "0x206150040",
            "EntityType": "ioc",
            "EntitySubType": "payload",
            "Labels": [
                "TA0005"
            ],
            "Times": [
                "4"
            ],
            "Properties": {
                "type": "MMIO register",
                "purpose": "Stores flags and physical address"
            }
        },
        {
            "EntityId": "entity_14",
            "EntityName": "0x206150048",
            "EntityType": "ioc",
            "EntitySubType": "payload",
            "Labels": [
                "TA0005"
            ],
            "Times": [
                "4"
            ],
            "Properties": {
                "type": "MMIO register",
                "purpose": "Stores data, address, hash and command"
            }
        },
        {
            "EntityId": "entity_15",
            "EntityName": "Custom hash algorithm",
            "EntityType": "tool",
            "EntitySubType": "method",
            "Labels": [
                "TA0005"
            ],
            "Times": [
                "4"
            ],
            "Properties": {
                "description": "20-bit hash using custom sbox table"
            }
        },
        {
            "EntityId": "entity_16",
            "EntityName": "IMAgent process",
            "EntityType": "asset",
            "EntitySubType": "bussiness",
            "Labels": [
                "TA0003"
            ],
            "Times": [
                "5"
            ]
        },
        {
            "EntityId": "entity_17",
            "EntityName": "Safari process",
            "EntityType": "asset",
            "EntitySubType": "bussiness",
            "Labels": [
                "TA0001"
            ],
            "Times": [
                "6"
            ]
        },
        {
            "EntityId": "entity_18",
            "EntityName": "Mach object file",
            "EntityType": "file",
            "EntitySubType": "file",
            "Labels": [
                "TA0002"
            ],
            "Times": [
                "7"
            ]
        },
        {
            "EntityId": "entity_19",
            "EntityName": "Spyware",
            "EntityType": "tool",
            "EntitySubType": "malware",
            "Labels": [
                "TA0010"
            ],
            "Times": [
                "8"
            ]
        }
    ],
    "Relationships": [
        {
            "RelationshipId": "relationship_1",
            "RelationshipType": "use",
            "Source": "Operation Triangulation",
            "Target": "CVE-2023-41990"
        },
        {
            "RelationshipId": "relationship_2",
            "RelationshipType": "use",
            "Source": "Operation Triangulation",
            "Target": "CVE-2023-32434"
        },
        {
            "RelationshipId": "relationship_3",
            "RelationshipType": "use",
            "Source": "Operation Triangulation",
            "Target": "CVE-2023-38606"
        },
        {
            "RelationshipId": "relationship_4",
            "RelationshipType": "use",
            "Source": "Operation Triangulation",
            "Target": "CVE-2023-32435"
        },
        {
            "RelationshipId": "relationship_5",
            "RelationshipType": "exploit",
            "Source": "CVE-2023-41990",
            "Target": "JavaScriptCore"
        },
        {
            "RelationshipId": "relationship_6",
            "RelationshipType": "related_to",
            "Source": "DollarVM ($vm)",
            "Target": "JavaScriptCore"
        },
        {
            "RelationshipId": "relationship_7",
            "RelationshipType": "exploit",
            "Source": "CVE-2023-38606",
            "Target": "GPU coprocessor"
        },
        {
            "RelationshipId": "relationship_8",
            "RelationshipType": "belong_to",
            "Source": "0x206040000",
            "Target": "GPU coprocessor"
        },
        {
            "RelationshipId": "relationship_9",
            "RelationshipType": "belong_to",
            "Source": "0x206140008",
            "Target": "GPU coprocessor"
        },
        {
            "RelationshipId": "relationship_10",
            "RelationshipType": "belong_to",
            "Source": "0x206140108",
            "Target": "GPU coprocessor"
        },
        {
            "RelationshipId": "relationship_11",
            "RelationshipType": "belong_to",
            "Source": "0x206150020",
            "Target": "GPU coprocessor"
        },
        {
            "RelationshipId": "relationship_12",
            "RelationshipType": "belong_to",
            "Source": "0x206150040",
            "Target": "GPU coprocessor"
        },
        {
            "RelationshipId": "relationship_13",
            "RelationshipType": "belong_to",
            "Source": "0x206150048",
            "Target": "GPU coprocessor"
        },
        {
            "RelationshipId": "relationship_14",
            "RelationshipType": "use",
            "Source": "Operation Triangulation",
            "Target": "Custom hash algorithm"
        },
        {
            "RelationshipId": "relationship_15",
            "RelationshipType": "affect",
            "Source": "Operation Triangulation",
            "Target": "IMAgent process"
        },
        {
            "RelationshipId": "relationship_16",
            "RelationshipType": "affect",
            "Source": "Operation Triangulation",
            "Target": "Safari process"
        },
        {
            "RelationshipId": "relationship_17",
            "RelationshipType": "use",
            "Source": "Operation Triangulation",
            "Target": "Mach object file"
        },
        {
            "RelationshipId": "relationship_18",
            "RelationshipType": "use",
            "Source": "Operation Triangulation",
            "Target": "Spyware"
        }
    ]
}